from numpy import *
#! Lab5 №1
train=(
       (0,0,0,0,0,1,
        0,0,0,0,1,0,
        0,0,0,1,0,0,
        0,0,1,0,0,0,
        0,1,0,0,0,0,
        1,0,0,0,0,0),

       (0,0,0,0,0,0,
        0,0,0,0,0,0,
        0,0,0,0,0,0,
        1,1,1,0,0,0,
        1,1,1,0,0,0,
        1,1,1,0,0,0),
        
        (0,0,0,1,1,1,
         0,0,0,1,1,1,
         0,0,0,1,1,1,
         0,0,0,0,0,0,
         0,0,0,0,0,0,
         0,0,0,0,0,0),
         
        (0,0,0,0,0,0,
         0,0,1,1,0,0,
         0,1,0,0,1,0,
         1,0,0,0,0,1,
         0,0,0,0,0,0,
         0,0,0,0,0,0)
       )

check=(
        (0,0,1,1,1,1,
         0,0,0,0,1,1,
         1,0,0,1,1,0,
         0,0,0,0,0,0,
         0,1,0,0,1,0,
         1,1,0,0,0,1),

        (0,0,0,0,0,1,
         0,0,0,1,1,0,
         0,0,0,1,0,1,
         0,0,1,0,0,0,
         0,0,0,0,0,0,
         0,0,0,0,0,0),

        (0,0,0,0,0,1,
         0,0,0,0,1,0,
         0,0,0,1,1,0,
         0,0,0,0,0,0,
         0,1,0,0,0,0,
         1,0,0,0,0,0),

        (0,0,0,0,0,1,
         0,0,0,0,1,0,
         0,0,0,1,0,0,
         0,0,1,0,0,0,
         0,1,0,0,0,0,
         1,0,0,0,0,0),

        (0,0,0,0,1,0,
         0,1,0,0,0,0,
         0,0,0,0,0,1,
         1,1,1,0,0,0,
         1,0,1,1,0,0,
         1,0,1,0,0,1),

        (0,0,0,0,0,0,
         0,0,0,0,0,0,
         0,0,0,0,0,0,
         1,1,1,0,0,0,
         1,1,1,0,0,0,
         1,1,1,0,0,0)
    )
test=((-1,1,-1,1),(1,-1,1,1),(1,-1,1,-1))

output=(1,-1,1,-1)

def main():
    ind=GetClass(test,output)
    print("Элемент {0} принадлежит классу {1} c индексом:{2}".format(output,test[ind],ind))
   
   
def GetWeigtMatrix(train):
    W=empty((len(train[0]),len(train[0])))
    for tr in train:
        V2=matrix(tr)
        V1=transpose(V2)
        W+=dot(V1,V2)
    W-=diag(diag(W))
    return W   

def GetClass(train,check):
    W=GetWeigtMatrix(test)
    y=transpose(matrix(check))
    y1=sign(dot(W,y))
    y2=sign(dot(W,y1))
    while not (y1==y2).all():
        y1=y2
        y2=sign(dot(W,y1))
    res=tuple(map(lambda x: x.tolist()[0][0],y2))
    return train.index(res)





if __name__=="__main__":
    main()